!function(){"use strict";function n(n){return 224===n?["00E0","CLS"]:238===n?["00EE","RET"]:n>>>12==0?["0nnn","SYS",4095&n]:n>>>12==1?["1nnn","JP",4095&n]:n>>>12==2?["2nnn","CALL",4095&n]:n>>>12==3?["3xkk","SE",(3840&n)>>>8,255&n]:n>>>12==4?["4xkk","SNE",(3840&n)>>>8,255&n]:n>>>12==5&&0==(15&n)?["5xy0","SE",(3840&n)>>>8,(240&n)>>>4]:n>>>12==6?["6xkk","LD",(3840&n)>>>8,255&n]:n>>>12==7?["7xkk","ADD",(3840&n)>>>8,255&n]:n>>>12==8&&0==(15&n)?["8xy0","LD",(3840&n)>>>8,(240&n)>>>4]:n>>>12==8&&1==(15&n)?["8xy1","OR",(3840&n)>>>8,(240&n)>>>4]:n>>>12==8&&2==(15&n)?["8xy2","AND",(3840&n)>>>8,(240&n)>>>4]:n>>>12==8&&3==(15&n)?["8xy3","XOR",(3840&n)>>>8,(240&n)>>>4]:n>>>12==8&&4==(15&n)?["8xy4","ADD",(3840&n)>>>8,(240&n)>>>4]:n>>>12==8&&5==(15&n)?["8xy5","SUB",(3840&n)>>>8,(240&n)>>>4]:n>>>12==8&&6==(15&n)?["8xy6","SHR",(3840&n)>>>8,(240&n)>>>4]:n>>>12==8&&7==(15&n)?["8xy7","SUBN",(3840&n)>>>8,(240&n)>>>4]:n>>>12==8&&14==(15&n)?["8xyE","SHL",(3840&n)>>>8,(240&n)>>>4]:n>>>12==9&&0==(15&n)?["9xy0","SNE",(3840&n)>>>8,(240&n)>>>4]:n>>>12==10?["Annn","LD",4095&n]:n>>>12==11?["Bnnn","JP",4095&n]:n>>>12==12?["Cxkk","RND",(3840&n)>>>8,255&n]:n>>>12==13?["Dxyn","DRW",(3840&n)>>>8,(240&n)>>>4,15&n]:n>>>12==14&&158==(255&n)?["Ex9E","SKP",(3840&n)>>>8]:n>>>12==14&&161==(255&n)?["ExA1","SKNP",(3840&n)>>>8]:n>>>12==15&&7==(255&n)?["Fx07","LD",(3840&n)>>>8]:n>>>12==15&&10==(255&n)?["Fx0A","LD",(3840&n)>>>8]:n>>>12==15&&21==(255&n)?["Fx15","LD",(3840&n)>>>8]:n>>>12==15&&24==(255&n)?["Fx18","LD",(3840&n)>>>8]:n>>>12==15&&30==(255&n)?["Fx1E","ADD",(3840&n)>>>8]:n>>>12==15&&41==(255&n)?["Fx29","LD",(3840&n)>>>8]:n>>>12==15&&51==(255&n)?["Fx33","LD",(3840&n)>>>8]:n>>>12==15&&85==(255&n)?["Fx35","LD",(3840&n)>>>8]:n>>>12==15&&101==(255&n)?["Fx65","LD",(3840&n)>>>8]:["ERROR",n.toString(16)]}var r="undefined"!=typeof window,t={el:"#app",width:500,prefix:"chip8"},e=Array.from({length:64},function(n){return Array.from({length:32},function(n){return 0})}),o=null,i=function(){e=e.map(function(n){return n.map(function(n){return 0})})},u=function(){var n=t.width/64;e.forEach(function(r,t){return r.forEach(function(r,e){o.fillStyle=r?"white":"black",o.fillRect(t*n,e*n,n,n)})})},a=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("undefined"!=typeof window){t=Object.assign(t,n);var r=document.createElement("style");document.head.appendChild(r),r.sheet.insertRule("canvas {\n      margin: auto;\n      display: block;\n      width: "+t.width+"px;\n      height: "+t.width/2+"px;\n    }",0);var e=document.querySelector(n.el);e.setAttribute("width",t.width+"px"),e.setAttribute("height",t.width/2+"px"),o=e.getContext("2d"),u()}else console.log("Node ENV not supported")},f=function(n,t,o,i){for(var a=i.MEM.filter(function(n,r){return r>=i.I&&r<i.I+o}),f=0;f<8;f++)for(var c=0;c<o;c++){var V=f+n>63?127-(f+n):f+n,x=c+t>31?63-(c+t):c+t;e[V-1][x]=e[V-1][x]^a[c]>>7-f&1}return r?u():console.log("Drawing at ("+n+", "+t+") with "+o+" bytes"),!1},c={init:a,clear:i,draw:f},V=function(){function n(n,r){var t=[],e=!0,o=!1,i=void 0;try{for(var u,a=n[Symbol.iterator]();!(e=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);e=!0);}catch(n){o=!0,i=n}finally{try{!e&&a.return&&a.return()}finally{if(o)throw i}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return n(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),x="undefined"!=typeof window,C=function(n){var r=new Uint8Array(4095),t=[240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128];return n.forEach(function(n,t){r[t+512]=n}),t.forEach(function(n,t){r[t]=n}),r},P=function(n,r){return n[r]<<8|n[r+1]},d={"0nnn":function(n,r){throw r.PC+=2,Error("0nnn")},"00E0":function(n,r){return c.clear(),r.PC+=2,r},"00EE":function(n,r){return r.PC=r.STACK[--r.SP]+2,r},"1nnn":function(n,r){var t=V(n,3),e=t[2];return r.PC=e,r},"2nnn":function(n,r){var t=V(n,3),e=t[2];return r.STACK[r.SP++]=r.PC,r.PC=e,r},"3xkk":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]===o?r.PC+=4:r.PC+=2,r},"4xkk":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]!==o?r.PC+=4:r.PC+=2,r},"5xy0":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]===r.V[o]?r.PC+=4:r.PC+=2,r},"6xkk":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]=o,r.PC+=2,r},"7xkk":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]+=o,r.PC+=2,r},"8xy0":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]=r.V[o],r.PC+=2,r},"8xy1":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]=r.V[e]|r.V[o],r.PC+=2,r},"8xy2":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]=r.V[e]&r.V[o],r.PC+=2,r},"8xy3":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]=r.V[e]^r.V[o],r.PC+=2,r},"8xy4":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[15]=r.V[e]+r.V[o]>255?1:0,r.V[e]=r.V[e]+r.V[o],r.PC+=2,r},"8xy5":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[15]=r.V[e]>r.V[o]?1:0,r.V[e]=r.V[e]-r.V[o],r.PC+=2,r},"8xy6":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[15]=1&r.V[o],r.V[e]=r.V[o]>>1,r.PC+=2,r},"8xy7":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[15]=r.V[o]>r.V[e]?1:0,r.V[e]=r.V[o]-r.V[e],r.PC+=2,r},"8xyE":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[15]=r.V[o]>>7,r.V[e]=r.V[o]<<1,r.PC+=2,r},"9xy0":function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]!==r.V[o]?r.PC+=4:r.PC+=2,r},Annn:function(n,r){var t=V(n,3),e=t[2];return r.I=e,r.PC+=2,r},Bnnn:function(n,r){var t=V(n,3),e=t[2];return r.PC=e+r.V[0],r},Cxkk:function(n,r){var t=V(n,4),e=t[2],o=t[3];return r.V[e]=parseInt(255*Math.random())&o,r.PC+=2,r},Dxyn:function(n,r){var t=V(n,5),e=t[2],o=t[3],i=t[4];return r.V[15]=c.draw(r.V[e],r.V[o],i,r),r.PC+=2,r},Ex9E:function(n,r){var t=V(n,3),e=t[2];return r.KEYS[r.V[e]]?r.PC+=4:r.PC+=2,r},ExA1:function(n,r){var t=V(n,3),e=t[2];return r.KEYS[r.V[e]]?r.PC+=2:r.PC+=4,r},Fx07:function(n,r){var t=V(n,3),e=t[2];return r.V[e]=r.DELAY,r.PC+=2,r},Fx0A:function(n,r){var t=V(n,3),e=t[2],o=parseInt(16*Math.random());return console.log("Mock press",o.toString(16)),r.V[e]=o,r.PC+=2,r},Fx15:function(n,r){var t=V(n,3),e=t[2];return r.DELAY=r.V[e],r.PC+=2,r},Fx18:function(n,r){var t=V(n,3),e=t[2];return r.SOUND=r.V[e],r.PC+=2,r},Fx1E:function(n,r){var t=V(n,3),e=t[2];return r.I=r.I+r.V[e],r.PC+=2,r},Fx29:function(n,r){var t=V(n,3),e=t[2];return r.I=5*r.V[e],r.PC+=2,r},Fx33:function(n,r){var t=V(n,3),e=t[2];return r.MEM[r.I]=Math.floor(r.V[e]/100),r.MEM[r.I+1]=Math.floor(r.V[e]%100/10),r.MEM[r.I+2]=r.V[e]%10,r.PC+=2,r},Fx55:function(n,r){for(var t=V(n,3),e=t[2],o=0;o<=e;o++)r.MEM[r.I++]=r.V[o];return r.PC+=2,r},Fx65:function(n,r){for(var t=V(n,3),e=t[2],o=0;o<=e;o++)r.V[o]=r.MEM[r.I++];return r.PC+=2,r}},l=function(r,t,e){function o(){var r=5;for(t.DELAY=Math.max(0,t.DELAY-1);r>0;){var e=n(P(t.MEM,t.PC));try{d[e[0]](e,t)}catch(n){throw console.log("\nLast state:"),console.log({INS:e,V:Array.from(t.V).map(function(n){return n.toString(16)}).join(" "),I:"0x"+t.I.toString(16),PC:"0x"+t.PC.toString(16),SP:t.SP,STACK:t.STACK}),n}r--}x&&window.requestAnimationFrame(o)}x?window.requestAnimationFrame(o):setInterval(function(){return o()},1e3/60)},v={initMem:C,ops:d,load:function(n,r){var t={MEM:C(n),V:new Uint8Array(16),STACK:new Uint16Array(16),KEYS:Array.from({length:16},function(n){return!1}),I:0,PC:512,SP:0,DELAY:0,SOUND:0};c.init(r),"undefined"!=typeof window&&(window.KEYS=t.KEYS),l(0,t)}},y=function(n,r){v.load(n,r)};"undefined"!=typeof window&&(window.chip8={load:y});var E={load:y},w={el:"#app",width:500,speed:1},h=new XMLHttpRequest;h.open("GET","/roms/PONG",!0),h.responseType="arraybuffer",h.onload=function(){var n=new Uint8Array(h.response);E.load(n,w)},h.send()}();
